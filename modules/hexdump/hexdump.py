import binascii # to convert binary to hex
import os, sys

def hexdump(filename):

	# start function variables
	(file, ext) 	= os.path.splitext(filename)
	outputFileName 	=	file+".hexcode" 
	
	# Read the code from the file
	try:
		code = open(filename, 'rb').read()
		hexcode = binascii.hexlify(code)
	except Exception as err:
		print str(err)
	
	outfile = open(outputFileName, 'w')
	outfile.write(hexcode)
	print outputFileName+" hex code dumped."
	return hexcode
	
def hexdumpFolder(directory,extensionList):
	for root, dirs, files in os.walk(directory):
		for file in files:
			(filename, ext)	= os.path.splitext(file)
			if ext in extensionList:
				filename = root+"\\"+file
				hexcode  = hexdump(filename)

# Test ...			
#hexdump('C:\\Users\\asus\\Desktop\\test\\all_viruses_exe\\type1_2_3_4_5_6_9\\ngvck_type1_1000.EXE')
#hexdumpFolder('C:\\Users\\asus\\Desktop\\test\\all_viruses_exe\\type1_2_3_4_5_6_9\\',[".exe",".EXE",".dll",".DLL",".com",".COM"])

# Running ...
#hexdumpFolder('C:\\Users\\asus\\Desktop\\win7_8_mixBeningFiles\\',[".exe",".EXE",".dll",".DLL",".com",".COM"])
# hexdumpFolder('C:\\Users\\asus\\Desktop\\MetamorfikBackup\\all_ngvck_viruses_exe\\',[".exe",".EXE",".dll",".DLL",".com",".COM"])
hexdumpFolder('C:\\Users\\asus\\Desktop\\workspace\\G2\\',[".exe",".EXE",".dll",".DLL",".com",".COM"])
